// prisma/schema.prisma

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

//
// MODELO PROFESSOR
//
model Professor {
  id           Int        @id @default(autoincrement())
  firstName    String
  lastName     String
  email        String     @unique
  passwordHash String
  specialty    String
  phone        String     // obligatorio
  isApproved   Boolean    @default(false)
  createdAt    DateTime   @default(now())

  students     Student[]
}

//
// MODELO STUDENT
//
model Student {
  id           Int        @id @default(autoincrement())
  firstName    String
  lastName     String
  age          Int
  sex          String
  weightKg     Float
  heightCm     Float
  professorId  Int
  createdAt    DateTime   @default(now())

  professor    Professor  @relation(fields: [professorId], references: [id])
  goals        Goal[]
  progressLogs ProgressLog[]
}

//
// MODELO GOAL (Objetivos del alumno)
//
model Goal {
  id           Int       @id @default(autoincrement())
  studentId    Int
  title        String
  description  String?
  targetType   String       // weight_loss_kg, custom, etc.
  targetValue  Float?
  startDate    DateTime
  endDate      DateTime
  reward       String?
  status       String    @default("pending") // pending, in_progress, completed, failed

  student      Student   @relation(fields: [studentId], references: [id])
  progressLogs ProgressLog[]
}

//
// MODELO PROGRESS LOG (Registros de progreso)
//
model ProgressLog {
  id          Int       @id @default(autoincrement())
  studentId   Int
  goalId      Int?
  date        DateTime  @default(now())
  weightKg    Float?
  notes       String?

  student     Student   @relation(fields: [studentId], references: [id])
  goal        Goal?     @relation(fields: [goalId], references: [id])
}
